# Production Environment Configuration
# This file contains production-specific environment variable templates
# DO NOT commit actual production secrets to version control

# ============================================================================
# Node Environment
# ============================================================================
NODE_ENV=production

# ============================================================================
# Database Configuration
# ============================================================================

# PostgreSQL Database URL (Production)
# Use a managed PostgreSQL service like:
# - Vercel Postgres: https://vercel.com/docs/storage/vercel-postgres
# - Neon: https://neon.tech/
# - Supabase: https://supabase.com/
# - AWS RDS: https://aws.amazon.com/rds/
#
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?sslmode=require
# IMPORTANT: Always use SSL in production (sslmode=require)
DATABASE_URL="postgresql://username:password@your-production-db.example.com:5432/compilothq_production?sslmode=require"

# Redis URL (for sessions, caching, job queues)
# Use a managed Redis service like:
# - Upstash Redis: https://upstash.com/
# - Redis Cloud: https://redis.com/redis-enterprise-cloud/
# - AWS ElastiCache: https://aws.amazon.com/elasticache/
#
# Format: redis://:password@host:port
REDIS_URL="redis://:your-redis-password@your-redis-host.example.com:6380"

# ============================================================================
# Authentication Configuration (NextAuth.js v5)
# ============================================================================

# NextAuth.js Production URL
# MUST match your production domain exactly
# Examples:
#   - https://app.compilo.io
#   - https://www.yourcompany.com
# NO trailing slash
NEXTAUTH_URL="https://your-production-domain.com"

# NextAuth.js Secret (CRITICAL - Keep Secure!)
# Generate a new secret for production: openssl rand -base64 32
# Store in your deployment platform's secret management:
#   - Vercel: Project Settings > Environment Variables (Sensitive)
#   - Railway: Variables (Encrypted)
#   - AWS: Secrets Manager or Parameter Store
# NEVER reuse development secrets in production
NEXTAUTH_SECRET="REPLACE_WITH_PRODUCTION_SECRET_FROM_openssl_rand_base64_32"

# Google OAuth Configuration (Production)
# 1. Go to: https://console.cloud.google.com/apis/credentials
# 2. Create a NEW OAuth 2.0 Client ID for production
# 3. Add authorized redirect URI: https://your-domain.com/api/auth/callback/google
# 4. Add authorized JavaScript origins: https://your-domain.com
# 5. Copy Client ID and Client Secret
# IMPORTANT: Use separate OAuth credentials for production (not dev credentials)
GOOGLE_CLIENT_ID="your-production-google-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-production-google-client-secret"

# Email Provider Configuration (Resend - Production)
# 1. Create production API key at: https://resend.com/api-keys
# 2. Add and verify your production sending domain
# 3. Configure domain DNS records (SPF, DKIM, DMARC)
# 4. Test email delivery before going live
# IMPORTANT: Use a separate API key for production
RESEND_API_KEY="re_your_production_resend_api_key_here"

# ============================================================================
# Application Configuration
# ============================================================================

# Public App Configuration
# These values are embedded in the client-side bundle
NEXT_PUBLIC_APP_NAME="Compilo"
NEXT_PUBLIC_APP_URL="https://your-production-domain.com"

# Feature Flags (Production)
# Enable/disable features in production
NEXT_PUBLIC_FEATURE_QUESTIONNAIRES="true"
NEXT_PUBLIC_FEATURE_DOCUMENT_GENERATION="true"
NEXT_PUBLIC_FEATURE_AI_ASSISTANCE="false"

# ============================================================================
# Monitoring & Observability (Optional but Recommended)
# ============================================================================

# Sentry (Error Tracking)
# Sign up at: https://sentry.io/
# NEXT_PUBLIC_SENTRY_DSN="https://your-sentry-dsn@sentry.io/project-id"
# SENTRY_AUTH_TOKEN="your-sentry-auth-token"

# PostHog (Analytics & Feature Flags)
# Sign up at: https://posthog.com/
# NEXT_PUBLIC_POSTHOG_KEY="phc_your_posthog_key"
# NEXT_PUBLIC_POSTHOG_HOST="https://app.posthog.com"

# Axiom or Logflare (Logging)
# AXIOM_TOKEN="your-axiom-token"
# AXIOM_DATASET="your-dataset-name"

# ============================================================================
# Security Headers & CORS (Optional)
# ============================================================================

# Allowed origins for CORS (if using API from different domains)
# ALLOWED_ORIGINS="https://your-domain.com,https://www.your-domain.com"

# Content Security Policy (CSP) nonce generation
# NEXT_PUBLIC_CSP_NONCE_ENABLED="true"

# ============================================================================
# Performance & Scaling (Optional)
# ============================================================================

# Database Connection Pooling
# Recommended for production to handle concurrent connections
# DATABASE_POOL_SIZE="20"
# DATABASE_POOL_TIMEOUT="30000"

# Rate Limiting
# RATE_LIMIT_MAX_REQUESTS="100"
# RATE_LIMIT_WINDOW_MS="900000"  # 15 minutes

# ============================================================================
# Pre-Deployment Checklist
# ============================================================================
#
# Before deploying to production, ensure:
#
# ✅ Database Migration
#    - Run: pnpm db:migrate:dev -- --name add-nextauth-models
#    - Verify all tables created: Account, Session, VerificationToken, Invitation
#
# ✅ Google OAuth Setup
#    - Created production OAuth credentials
#    - Added production callback URL
#    - Tested OAuth flow in staging environment
#
# ✅ Resend Email Setup
#    - Verified production sending domain
#    - DNS records configured (SPF, DKIM, DMARC)
#    - Tested magic link and invitation emails
#
# ✅ Environment Variables
#    - All secrets generated fresh for production
#    - Secrets stored in deployment platform (not in .env file)
#    - NEXTAUTH_SECRET is unique and secure (32+ characters)
#    - NEXTAUTH_URL matches production domain exactly
#
# ✅ Security
#    - SSL/TLS certificate configured for database
#    - All HTTP connections forced to HTTPS
#    - Session cookies set to Secure, HttpOnly, SameSite=Lax
#    - CORS configured properly
#
# ✅ Testing
#    - All 96 tests passing
#    - Manual testing of critical flows completed
#    - Email delivery verified
#    - Google OAuth verified
#
# ✅ Monitoring
#    - Error tracking configured (Sentry recommended)
#    - Logging configured (Axiom/Logflare recommended)
#    - Analytics configured (PostHog recommended)
#
# ============================================================================
# Deployment Platform Specific Notes
# ============================================================================
#
# VERCEL:
# - Use Vercel Postgres for DATABASE_URL
# - Use Vercel KV (Redis) for REDIS_URL
# - Add environment variables in Project Settings > Environment Variables
# - Mark sensitive values as "Sensitive" to hide them
# - Set environment to "Production" only (not Preview)
#
# RAILWAY:
# - Use Railway PostgreSQL plugin for DATABASE_URL
# - Use Railway Redis plugin for REDIS_URL
# - Add variables in project settings (automatically encrypted)
# - Use ${{RAILWAY_STATIC_URL}} for NEXTAUTH_URL if using Railway domain
#
# AWS (ECS/EC2):
# - Use AWS RDS for PostgreSQL
# - Use AWS ElastiCache for Redis
# - Store secrets in AWS Secrets Manager
# - Reference secrets in task definition or via environment
#
# DOCKER:
# - Use .env.production file (DO NOT commit to repo)
# - Mount as volume or use docker-compose env_file
# - Consider using Docker secrets for sensitive values
#
